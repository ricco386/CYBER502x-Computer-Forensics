

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Unit 2 - Linux/Unix Acquisition &mdash; RITx: CYBER502x Computer Forensics - Personal study notes  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Unit 3 - Unix/Linux File System" href="Unit_3.html" />
    <link rel="prev" title="Unit 1 - Computer Forensics Fundamentals" href="Unit_1.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> RITx: CYBER502x Computer Forensics - Personal study notes
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Unit_1.html">Unit 1 - Computer Forensics Fundamentals</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Unit 2 - Linux/Unix Acquisition</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#acquisition-preparation-and-system-information-acquisition">Acquisition Preparation and System Information Acquisition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#volatile-data-acquisition">Volatile data acquisition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#collect-information-from-a-live-system">Collect information from a live system</a></li>
<li class="toctree-l3"><a class="reference internal" href="#memory-acquisition">Memory Acquisition</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#nonvolatile-data-acquisition">Nonvolatile data acquisition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#forensic-imaging-of-drives">Forensic Imaging of Drives</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Unit_3.html">Unit 3 - Unix/Linux File System</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">RITx: CYBER502x Computer Forensics - Personal study notes</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Unit 2 - Linux/Unix Acquisition</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Unit_2.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="unit-2-linux-unix-acquisition">
<span id="unit2"></span><h1>Unit 2 - Linux/Unix Acquisition<a class="headerlink" href="#unit-2-linux-unix-acquisition" title="Permalink to this headline">¶</a></h1>
<div class="section" id="acquisition-preparation-and-system-information-acquisition">
<span id="unit2-acquisition-preparation-and-system-information-acquisition"></span><h2>Acquisition Preparation and System Information Acquisition<a class="headerlink" href="#acquisition-preparation-and-system-information-acquisition" title="Permalink to this headline">¶</a></h2>
<p>Linux/Unix forensics follows the general forensic process of <strong>collecting, preserving, analyzing, and reporting evidence</strong>.</p>
<ol class="arabic">
<li><p>First is a set of forensic tools, including a bootable live CD.</p>
<p>The reason is simple: You should never trust any tools from the suspect machine since it has potentially compromised.
When booting using a forensic bootable CD in forensic mode, the internal suspect hard drive is not touched.</p>
</li>
<li><p>Second is a powerful machine, sometimes we call it forensic machine or evidence server.</p>
<p>This system has forensic tools installed and its drives are wiped clean for storing acquired evidence.</p>
</li>
</ol>
</div>
<div class="section" id="volatile-data-acquisition">
<span id="unit2-volatile-data-acquisition"></span><h2>Volatile data acquisition<a class="headerlink" href="#volatile-data-acquisition" title="Permalink to this headline">¶</a></h2>
<p>Volatile evidence is evidence that can easily be changed. Every memory dump will be different since memory is constantly changing. That’s why we should first acquire the data that is most volatile.</p>
<p>A possible order of collection from most volatile to least volatile until non-volatile is memory; swap space or page file; network status; connections; processes running; open files; drives, and removable media.</p>
<p>Since you are directly collecting volatile evidence from a suspect machine, you are inevitably changing data. To ensure a minimal impact to the original data, you should always try to use small footprint tools and
you should always document everything you have done.</p>
<div class="section" id="collect-information-from-a-live-system">
<span id="unit2-collect-information-from-live-system"></span><h3>Collect information from a live system<a class="headerlink" href="#collect-information-from-a-live-system" title="Permalink to this headline">¶</a></h3>
<p>On potentially compromised system we cannot trust anything, any tool from this machine. Use trusted tools from somewhere else, eg. a mounted USB.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When we run any commands the output has to be saved to outside from potentially compromised machine, eg. a mounted USB.</p>
</div>
<p>On the beging of collecting evidence we store date, how long is the machine booted, logged in users and some basic information about the machine</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ date
St jan 29 23:07:00 CET 2020
$ uptime
 23:07:27 up 44 min,  2 users,  load average: 0,00, 0,02, 0,30
$ uname -a
Linux l430 5.3.16-300.fc31.x86_64 #1 SMP Fri Dec 13 17:59:04 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux
$ w
 18:06:00 up 21 days, 23:14,  1 user,  load average: 1,84, 1,27, 1,11
USER     TTY        LOGIN@   IDLE   JCPU   PCPU WHAT
ricco    tty2      08jan20 21days  0.05s  0.05s /usr/libexec/gnome-session-binary
</pre></div>
</div>
<p id="network-interface-promisc-mode">Check the network interfaces information, and find out if any is switched to <strong>PROMISC mode</strong>. In promisc mode and it is listening for all the traffic passing through,
even the <a class="reference external" href="https://ricco386.github.io/CYBER501x-Cybersecurity-Fundamentals/html/Unit_4.html#unit4-packets-routing" title="(in RITx: CYBER501x Cybersecurity Fundamentals - Personal study notes)"><span class="xref std std-ref">packets</span></a> is not destinate to this machine it will also collect. A compromised machine, might have promisc mode, so it will try to listening for everything it’s passed into this network.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ifconfig
</pre></div>
</div>
<p id="command-netstat">List network connections and the <a class="reference external" href="https://ricco386.github.io/CYBER501x-Cybersecurity-Fundamentals/html/Unit_5.html#unit5-ports" title="(in RITx: CYBER501x Cybersecurity Fundamentals - Personal study notes)"><span>Ports</span></a> that are open:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ netstat -tulpen
</pre></div>
</div>
<p id="command-ps">List processes running on the system:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ps -eaf
</pre></div>
</div>
<p id="command-lsof">List of open files (with multiple variants):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ lsof -i 4  # list of open files all files opened with network connection
$ lsof -p 2918  # list of open files for preocess 2918
$ lsof +L1 # list of open files with link count less than 1, e.g. deleted files, not visible by ls (deleted), but still in memory
</pre></div>
</div>
<p>If we want to find UID zero (which is root owned, root owned UID is powerful during the execution time you have the root privilege). And then the permission, the perm, for set UID is 4000 and for set GID is 2000.
And we don’t want to see error messages because you will see permission denied and lots of permission denied issues so the output will be cleaner. Investigator will look into this list and try to find any malicious set UID program.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ find / -uid 0 -perm 4000 2&gt; /dev/null
</pre></div>
</div>
</div>
<div class="section" id="memory-acquisition">
<span id="unit2-memory-acquisition"></span><h3>Memory Acquisition<a class="headerlink" href="#memory-acquisition" title="Permalink to this headline">¶</a></h3>
<p>For a host-based memory dump approach, the investigator needs to have physical access to the system. MEMDUMP is a part of the coroner’s toolkit, TCT. To overcome memdump limitations, open source tools, Linux Memory Extractor,
<cite>LiME &lt;https://github.com/504ensicslabs/lime&gt;_</cite>, and Fmem were developed. Both tools will load a kernel module to the system that allows full memory captures.</p>
<p>A commercial tool called F-Response allows examiners to conduct forensic acquisition remotely. F-Response use a pair of dongles, one for the suspect system and another for the forensic system.</p>
<p>We need to have trusted tools available on a suspected machine. Insert mod and then the module name certainly is the <cite>LiME &lt;https://github.com/504ensicslabs/lime&gt;_</cite> module we are interested.
We want to insert this module into the kernel and the path specifies where this image dump will be reside:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ insmod lime-4.2.0-27-generic.ko &quot;path=/mnt/evidence_folder/memory_dump.bin format=padded&quot;
</pre></div>
</div>
<p>Once the dump is finished, we need to do a cleanup. First remove the lime module from the memory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ lsmod | grep lime
$ rmmod lime
</pre></div>
</div>
<p id="command-strings">We’ll have <cite>memory_dump.bin</cite> in out safe directory, eg. on a mounted USB. It’s a binary file. We want to try a very simple tool called a <cite>strings</cite>, it is able to print out certain lengths of strings, the lengths
by default is greater not equal to 4 bytes. Lets do a search in the memory dump for the string greater than 8 bytes and starting with the word forensics:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ strings -n 8 /mnt/evidence_folder/memory_dump.bin | grep ^forensics
</pre></div>
</div>
</div>
</div>
<div class="section" id="nonvolatile-data-acquisition">
<span id="unit2-nonvolatile-data-acquisition"></span><h2>Nonvolatile data acquisition<a class="headerlink" href="#nonvolatile-data-acquisition" title="Permalink to this headline">¶</a></h2>
<div class="section" id="forensic-imaging-of-drives">
<span id="unit2-forensic-imaging-of-drives"></span><h3>Forensic Imaging of Drives<a class="headerlink" href="#forensic-imaging-of-drives" title="Permalink to this headline">¶</a></h3>
<p>Be aware that certain types of hard drives and solid state drives may self-destroy any data on the drive when you remove the device or power it off completely. Toshiba is one example.</p>
<p>There are many high speed forensic images in the market. High speed forensic images can copy up to 30 gigabytes per minute and usually have built-in write blocker functionalities. Software-based imaging tools like <cite>FTK Imager</cite> and
<cite>dd</cite> can also be used to create a bit-stream copy of drives. However, you will need a write blocker to separate the original drives from the imaging software to prevent software from modifying data in original drives.
Most of these imaging tools will generate the hash value automatically after the imaging is done.</p>
<p id="command-dd"><cite>dd</cite> reads input blocks one at a time from block level device and it puts them into a memory buffer, applies the selected conversions, then outputs from buffer to the desired location, with a default block size of 512 bytes.</p>
<p>To copy our physical device data, we simply use <cite>dd</cite> to move chunks of bits from a source device to a destination device, ignoring the end of file marker. <cite>dd</cite> copies metadata and the data blocks in their entirety.
<cite>dd</cite> can redirect by pipe to netcat or other applications to send the data to a networked machine.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ dd if=/source/file of=/destination/file
$ dd if=/source/file | nc 192.168.1.2 2222
</pre></div>
</div>
<p>conv equal to noerror and sync is often used for forensic imaging to skip the unreadable sectors and then continue copying. More specifically, conv equal to noerror will instruct <cite>dd</cite> to pad the bad sectors with zeros
and move on to continue copying the rest of the data.
The sync option instructs <cite>dd</cite> to keep the sectors in the target device aligned with those from the source device. Thus, they data will not be misplaced in the wrong physical location on the destination copy.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ dd if=/source/file of=/destination/file conv=noerror,sync
</pre></div>
</div>
<p>Since <cite>dd</cite> is a simple tool for data duplication, it will not calculate the hash value for the newly generated image. Therefore, after imaging process is complete, it is your responsibility to compute hash values for both
the original source and <cite>dd</cite> image. Only if the hashes match, your forensic imaging process is done.</p>
<p>If <cite>/source/file</cite> has a bad sector and you use the <cite>conv=noerror</cite> option, you have a complicated and interesting case, as the hash values will be different, due to the padding of zeros.</p>
<p>Besides creating forensic imaging, <cite>dd</cite> has other uses.</p>
<p>You can use <cite>dd</cite> to wiping the drive with all zeros using this command. This process will basically fill your target drive with zeros, overriding any data as it goes. Some sources say that very old hard drives might still contain
residual data that an electron microscope might pick up after one pass of cleaning. Therefore, the Department of Defense standard for unclassified hard drive dispersion requires three passes over every byte. Some researchers
even suggest the seven passes of wiping. After wiping, you can reformat drive.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ dd if=/dev/zero of=/dev/hdb
</pre></div>
</div>
<p>examples of using DD for forensic imaging.</p>
<p>In drive to drive imaging, you physically remove the drive from the suspect computer and connect suspected drive to forensics machine with a write blocker. Assume <cite>hdb</cite> is a clean, wiped drive filled with all zero and
<cite>hdb</cite>’s capacity is larger than slash dev slash <cite>hda</cite>. We can use both <cite>dd</cite> copies below to copy the content.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ dd if=/dev/hda of=/dev/hdb
</pre></div>
</div>
<p>Since the size of <cite>hdb</cite> is larger than <cite>hda</cite>, after <cite>dd</cite> is done, <cite>hdb</cite> will contain the data from the source followed by a bunch of zeros. Therefore, the hash value of <cite>hdb</cite> will not be the same as the hash of <cite>hda</cite>,
due to those extra zeros.</p>
<p>To obtain the same hash value, you can use <cite>dd</cite> to carve out the number of blocks copied form <cite>hda</cite>, leaving out zeros. Using the second command, since evidence dot <cite>dd</cite> is a file containing exactly the data from <cite>hda</cite>,
assuming <cite>dd</cite> copied successfully, the hash value of <cite>hda</cite> will be the same as the hash value of the file <cite>evidence.dd</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ dd if=/dev/hda of=/case1/evidence.dd
</pre></div>
</div>
<p><cite>dd</cite> has siblings, <cite>sdd</cite>, and <cite>dcfldd</cite>. Both of them improved <cite>dd</cite>’s functionalities by achieving better performance and also providing copy progresses.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Unit_3.html" class="btn btn-neutral float-right" title="Unit 3 - Unix/Linux File System" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Unit_1.html" class="btn btn-neutral float-left" title="Unit 1 - Computer Forensics Fundamentals" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Richard von Kellner. MIT License.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>